<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imposter Game</title>
<style>
body { background-color: #121212; color: #eee; font-family: Arial; text-align: center; margin:0; padding:0; }
h1 { margin-top: 20px; font-size: 28px; }
button { background-color: #1e1e1e; color: white; border: none; padding: 12px; margin: 6px; border-radius: 10px; font-size: 18px; width: 80%; cursor: pointer; }
button.green { background-color: #4CAF50; }
button.gray { background-color: #2a2a2a; }
input { padding: 10px; font-size: 18px; width: 70%; margin-bottom: 12px; }
#players button { width: 90%; cursor: pointer; }
.screen { display: none; }
.screen.active { display: block; }
.container { padding: 20px; }
.toggle-btn { width: 80%; cursor: pointer; }
#homeButton { position: fixed; top: 10px; right: 10px; width: auto; padding: 8px 12px; font-size: 14px; border-radius: 6px; background-color:#4CAF50; cursor: pointer; }
#turnInfo { margin-top: 12px; font-size: 16px; color:#ccc; }
pre { text-align:left; white-space: pre-wrap; }
</style>
</head>
<body>

<div class="container">

<h1>Imposter Game</h1>

<button id="homeButton">üè† Home</button>
<div id="turnInfo"></div>

<!-- SETUP SCREEN -->
<div id="setup" class="screen active">
    <input type="text" id="playerName" placeholder="Player name">
    <button id="addPlayerBtn">Add Player</button>
    <div id="players"></div>
    <button id="startGameBtn" class="green">START GAME</button>

    <div style="margin-top:20px;">
        <button id="topicToggle" class="toggle-btn green">Show Topic to Players: ON</button><br>
        <button id="hintToggle" class="toggle-btn green">Imposter sees Hint: ON</button>
    </div>

    <div style="margin-top:20px;">
        <h3>Manage Topics</h3>
        <input type="text" id="newTopic" placeholder="New topic name">
        <button id="addTopicBtn">Add Topic</button><br><br>
        <input type="text" id="topicSelect" placeholder="Topic for word">
        <input type="text" id="newWord" placeholder="Word">
        <input type="text" id="newHint" placeholder="Hint">
        <button id="addWordBtn">Add Word</button>
    </div>
</div>

<!-- REVEAL SCREEN -->
<div id="revealScreen" class="screen">
    <h2 id="revealName"></h2>
    <p>Is this you? Make sure no one else is looking üëÄ</p>
    <button id="showRoleBtn" class="green">YES ‚Äì SHOW MY ROLE</button><br>
    <button id="backToPlayersBtn" class="gray">NO ‚Äì GO BACK</button>
</div>

<!-- ROLE SCREEN -->
<div id="roleScreen" class="screen">
    <h2 id="roleTitle"></h2>
    <pre id="roleText" style="font-size:18px;"></pre>
    <button id="doneRoleBtn" class="green">DONE (PASS PHONE)</button>
</div>

<!-- STARTER SCREEN -->
<div id="starterScreen" class="screen">
    <h2>All players have seen their roles</h2>
    <h2 id="starterText"></h2>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function() {

    // ------------------------
    // Topics (full from your JSON)
    // ------------------------
    const defaultTopics = {
      "Places": {
        "School":"Books","Airport":"Waiting","Hospital":"Bright lights","Beach":"Bare feet","Mall":"Crowds",
        "Gym":"Sweat","Library":"Whispers","Office":"Schedules","Restaurant":"Menus","Park":"Benches",
        "Theater":"Darkness","Stadium":"Echoes","Cafe":"Aroma","Train Station":"Tracks","Museum":"Artifacts",
        "Hotel":"Luggage","Bank":"Lines","Playground":"Slides","Cinema":"Popcorn","Bridge":"Height",
        "Forest":"Leaves","Zoo":"Cages","Airport Lounge":"Comfort","Parking Lot":"Spaces","Temple":"Incense"
      },
      "Animals": {
        "Dog":"Leash","Cat":"Silence","Elephant":"Memory","Lion":"Territory","Penguin":"Waddle","Shark":"Movement",
        "Horse":"Rhythm","Bird":"Height","Snake":"Stillness","Bear":"Weight","Rabbit":"Startle","Wolf":"Distance",
        "Frog":"Jump","Fox":"Cunning","Dolphin":"Echo","Giraffe":"Neck","Kangaroo":"Pouch","Owl":"Night",
        "Tiger":"Stripes","Elephant Seal":"Bulk","Crab":"Sideways","Ant":"March","Bee":"Buzz","Butterfly":"Flutter",
        "Squirrel":"Scurry"
      },
      "Food": {
        "Pizza":"Grease","Burger":"Hands","Sushi":"Precision","Tacos":"Messy","Pasta":"Twisting","Ice Cream":"Dripping",
        "Steak":"Cut","Soup":"Steam","Salad":"Mixing","Sandwich":"Layers","Pancakes":"Stacking","Fries":"Salt",
        "Bagel":"Spread","Dumplings":"Fold","Donut":"Sprinkles","Chocolate":"Sweet","Apple Pie":"Cinnamon",
        "Rice":"Bowl","Popcorn":"Kernel","Hotdog":"Ketchup","Omelette":"Fold","Cheese":"Stretch","Sausage":"Link",
        "Cereal":"Milk","Smoothie":"Blend"
      },
      "Objects": {
        "Phone":"Vibration","Laptop":"Keys","Backpack":"Weight","Watch":"Glance","Headphones":"Isolation",
        "Chair":"Stillness","Table":"Surface","Mirror":"Reflection","Door":"Pause","Wallet":"Routine",
        "Keys":"Pocket","Lamp":"Glow","Book":"Pages","Pen":"Tip","Glasses":"Sight","Bag":"Strap",
        "Camera":"Lens","Bottle":"Cap","Cup":"Sip","Phone Charger":"Cord","Umbrella":"Rain","Shoes":"Step",
        "Hat":"Shade","Clock":"Tick","TV":"Screen"
      },
      "Jobs": {
        "Teacher":"Repetition","Doctor":"Late nights","Engineer":"Diagrams","Chef":"Timing","Firefighter":"Heat",
        "Programmer":"Debugging","Artist":"Blank space","Writer":"Drafts","Cashier":"Scanning","Mechanic":"Hands",
        "Photographer":"Angles","Manager":"Meetings","Nurse":"Rounds","Actor":"Stage","Pilot":"Controls",
        "Dancer":"Movement","Musician":"Notes","Farmer":"Harvest","Baker":"Oven","Soldier":"March","Scientist":"Lab",
        "Barista":"Steam","Driver":"Wheel","Lawyer":"Arguments","Designer":"Sketch"
      },
      "Movies": {
        "Titanic":"Cold","Inception":"Layers","Star Wars":"Legacy","Jurassic Park":"Containment","The Matrix":"Choice",
        "Avengers":"Assembly","Jaws":"Anticipation","Rocky":"Persistence","Alien":"Isolation","Gladiator":"Crowd",
        "Interstellar":"Distance","Up":"Loss","Frozen":"Ice","Coco":"Memory","Finding Nemo":"Journey",
        "Incredibles":"Family","Shrek":"Swamp","Avatar":"Blue","Titan":"Fall","Hobbit":"Journey",
        "Harry Potter":"Magic","Moana":"Ocean","Black Panther":"Kingdom","Soul":"Music","Zootopia":"Animals"
      },
      "Video Games": {
        "Minecraft":"Blocks","Fortnite":"Circles","Among Us":"Silence","Zelda":"Puzzles","Call of Duty":"Reflexes",
        "Pokemon":"Collection","Skyrim":"Wandering","Mario Kart":"Momentum","Dark Souls":"Patience",
        "Valorant":"Positioning","Stardew Valley":"Routine","GTA":"Freedom","Animal Crossing":"Trading",
        "Overwatch":"Teamwork","League of Legends":"Lanes","Tetris":"Falling","The Sims":"Choices",
        "Fortnite Creative":"Build","Elden Ring":"Exploration","Hollow Knight":"Jumping","Candy Crush":"Matching",
        "Among Trees":"Survival","Terraria":"Mining","Subnautica":"Diving","Dead Cells":"Rolling"
      },
      "Fruits": {
        "Apple":"Crunch","Banana":"Peel","Orange":"Segments","Strawberry":"Seeds","Mango":"Juice",
        "Grapes":"Clusters","Pineapple":"Texture","Peach":"Fuzz","Cherry":"Pair","Watermelon":"Drips",
        "Blueberry":"Scatter","Lemon":"Reaction","Kiwi":"Hairy","Plum":"Stone","Pear":"Soft","Apricot":"Small",
        "Raspberry":"Tiny","Blackberry":"Bush","Cantaloupe":"Sweet","Papaya":"Tropical","Pomegranate":"Seeds",
        "Fig":"Soft","Coconut":"Hard shell","Grapefruit":"Bitter","Dragonfruit":"Spiky"
      },
      "Emotions": {
        "Happiness":"Lightness","Anger":"Heat","Fear":"Freeze","Sadness":"Weight","Excitement":"Buzz",
        "Guilt":"Avoidance","Relief":"Release","Loneliness":"Distance","Pride":"Posture","Jealousy":"Comparison",
        "Curiosity":"Questions","Frustration":"Tension","Surprise":"Jump","Confusion":"Frown","Hope":"Looking up",
        "Disgust":"Wrinkle","Love":"Warmth","Anxiety":"Fidget","Embarrassment":"Blush","Boredom":"Tap",
        "Contentment":"Sigh","Excitement":"Jump","Admiration":"Gaze","Shock":"Freeze","Nostalgia":"Memory"
      },
      "Activities": {
        "Driving":"Focus","Cooking":"Timing","Reading":"Immersion","Gaming":"Engagement","Exercising":"Breath",
        "Studying":"Repetition","Shopping":"Choices","Cleaning":"Order","Drawing":"Control","Writing":"Revising",
        "Swimming":"Stroke","Hiking":"Trail","Fishing":"Patience","Dancing":"Beat","Singing":"Pitch",
        "Painting":"Brush","Jogging":"Steps","Meditating":"Stillness","Photography":"Framing","Traveling":"Luggage",
        "Yoga":"Stretch","Camping":"Fire","Cycling":"Pedal","Skateboarding":"Ramp","Surfing":"Wave"
      }
    };
    let topics = JSON.parse(localStorage.getItem("imposterTopics")) || defaultTopics;

    // ------------------------
    // Game State
    // ------------------------
    let players = [];
    let roles = {};
    let viewed = [];
    let currentTopic = "";
    let currentWord = "";
    let currentHint = "";
    let starterPlayer = "";
    let showTopic = true;
    let showHint = true;
    let currentPlayer = "";

    // ------------------------
    // Helper: Switch Screen
    // ------------------------
    function switchScreen(from,to){
        if(from) document.getElementById(from).classList.remove('active');
        if(to) document.getElementById(to).classList.add('active');
        updateTurnInfo();
    }

    // ------------------------
    // Player Management
    // ------------------------
    function renderPlayers(){
        const playersDiv = document.getElementById('players');
        playersDiv.innerHTML = "";
        players.forEach(p=>{
            const btn = document.createElement('button');
            btn.textContent = p + (viewed.includes(p) ? " ‚úî" : "");
            btn.addEventListener('click',()=>confirmPlayer(p));
            playersDiv.appendChild(btn);
        });
        updateTurnInfo();
    }

    function addPlayer(){
        const nameInput = document.getElementById('playerName');
        const name = nameInput.value.trim();
        if(name && !players.includes(name)){
            players.push(name);
            nameInput.value="";
            renderPlayers();
        }
    }

    document.getElementById('addPlayerBtn').addEventListener('click', addPlayer);

    // ------------------------
    // Toggle Options
    // ------------------------
    document.getElementById('topicToggle').addEventListener('click',()=>{
        showTopic = !showTopic;
        const btn=document.getElementById('topicToggle');
        btn.textContent = `Show Topic to Players: ${showTopic?"ON":"OFF"}`;
        btn.className = showTopic?"toggle-btn green":"toggle-btn gray";
    });
    document.getElementById('hintToggle').addEventListener('click',()=>{
        showHint = !showHint;
        const btn=document.getElementById('hintToggle');
        btn.textContent = `Imposter sees Hint: ${showHint?"ON":"OFF"}`;
        btn.className = showHint?"toggle-btn green":"toggle-btn gray";
    });

    // ------------------------
    // Topic/Word Management
    // ------------------------
    document.getElementById('addTopicBtn').addEventListener('click',()=>{
        const t=document.getElementById('newTopic').value.trim();
        if(t && !topics[t]){
            topics[t]={};
            document.getElementById('newTopic').value="";
            localStorage.setItem('imposterTopics', JSON.stringify(topics));
            alert(`Added topic "${t}"`);
        }
    });
    document.getElementById('addWordBtn').addEventListener('click',()=>{
        const t=document.getElementById('topicSelect').value.trim();
        const w=document.getElementById('newWord').value.trim();
        const h=document.getElementById('newHint').value.trim();
        if(t && w && h){
            if(!topics[t]) topics[t]={};
            topics[t][w]=h;
            document.getElementById('topicSelect').value="";
            document.getElementById('newWord').value="";
            document.getElementById('newHint').value="";
            localStorage.setItem('imposterTopics', JSON.stringify(topics));
            alert(`Added word "${w}" to topic "${t}"`);
        }
    });

    // ------------------------
    // Game Logic
    // ------------------------
    document.getElementById('startGameBtn').addEventListener('click',()=>{
        if(players.length<3){ alert("Need at least 3 players"); return; }
        const topicKeys = Object.keys(topics);
        currentTopic = topicKeys[Math.floor(Math.random()*topicKeys.length)];
        const words = Object.entries(topics[currentTopic]);
        [currentWord,currentHint]=words[Math.floor(Math.random()*words.length)];

        const imposters = new Set();
        while(imposters.size<1){
            imposters.add(players[Math.floor(Math.random()*players.length)]);
        }
        roles = {};
        players.forEach(p=>roles[p]=imposters.has(p)?"IMPOSTER":"CREWMATE");
        viewed=[]; currentPlayer="";
        renderPlayers();
        alert("Game ready! Pass the phone. Tap your name to see your role.");
    });

    // ------------------------
    // Player/Role Flow
    // ------------------------
    function confirmPlayer(name){
        currentPlayer=name;
        document.getElementById('revealName').textContent=name;
        switchScreen('setup','revealScreen');
    }

    document.getElementById('backToPlayersBtn').addEventListener('click',()=>switchScreen('revealScreen','setup'));

    document.getElementById('showRoleBtn').addEventListener('click',()=>{
        const role=roles[currentPlayer];
        let text=role==="IMPOSTER"?"YOU ARE THE IMPOSTER\n":"YOU ARE A CREWMATE\n";
        if(role==="IMPOSTER"){
            if(showTopic) text+=`Topic: ${currentTopic}\n`;
            if(showHint) text+=`Hint: ${currentHint}`;
            if(!showTopic&&!showHint) text+="No extra info. Blend in üòà";
        } else {
            if(showTopic) text+=`Topic: ${currentTopic}\n`;
            text+=`Word: ${currentWord}`;
        }
        document.getElementById('roleTitle').textContent=currentPlayer;
        document.getElementById('roleText').textContent=text;
        switchScreen('revealScreen','roleScreen');
    });

    document.getElementById('doneRoleBtn').addEventListener('click',()=>{
        viewed.push(currentPlayer);
        renderPlayers();
        if(viewed.length===players.length){
            starterPlayer = players[Math.floor(Math.random()*players.length)];
            document.getElementById('starterText').textContent=`${starterPlayer} GOES FIRST üî•`;
            switchScreen('roleScreen','starterScreen');
        } else {
            switchScreen('roleScreen','setup');
        }
    });

    // ------------------------
    // Home Button
    // ------------------------
    document.getElementById('homeButton').addEventListener('click',()=>switchScreen(null,'setup'));

    // ------------------------
    // Turn Info
    // ------------------------
    function updateTurnInfo(){
        const div = document.getElementById('turnInfo');
        div.textContent=`Players done: ${viewed.length}/${players.length}`;
    }

}); // DOMContentLoaded
</script>

</body>
</html>
